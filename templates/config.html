{% extends "base.html" %}

{% block title %}Settings - MarkItDown API{% endblock %}

{% block content %}
<div class="config-container">
    <h1>Application Settings</h1>
    
    <form method="POST" action="{{ url_for('config_page') }}">
        <div class="config-section">
            <h2>Account Settings</h2>
            
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" value="{{ username }}" required>
                <small>Change your login username</small>
            </div>
            
            <div class="form-group">
                <label for="password">New Password</label>
                <input type="password" id="password" name="password">
                <small>Leave blank to keep current password</small>
            </div>
        </div>
        
        <div class="config-section">
            <h2>Application Configuration</h2>
            
            <div class="form-group">
                <label for="allowed_extensions">Allowed File Extensions</label>
                <input type="text" id="allowed_extensions" name="allowed_extensions" value="{{ allowed_extensions }}" required>
                <small>Comma-separated list (e.g., .pdf,.docx,.txt)</small>
            </div>
            
            <div class="form-group">
                <label for="max_file_size">Max File Size (bytes)</label>
                <input type="number" id="max_file_size" name="max_file_size" value="{{ max_file_size }}" required>
                <small>Maximum file size in bytes (e.g., 10485760 for 10MB)</small>
            </div>
            
            <div class="form-group">
                <label for="processing_timeout">Processing Timeout (seconds)</label>
                <input type="number" id="processing_timeout" name="processing_timeout" value="{{ processing_timeout }}" required>
                <small>Maximum time to process a document (e.g., 300 for 5 minutes)</small>
            </div>
            
            <div class="form-group">
                <label for="max_ocr_pages">Max OCR Pages</label>
                <input type="number" id="max_ocr_pages" name="max_ocr_pages" value="{{ max_ocr_pages }}" required>
                <small>Maximum number of pages to process with OCR (e.g., 50)</small>
            </div>
        </div>
        
        <div class="config-section">
            <h2>LLM Settings (AI-Powered Summarization & Correction)</h2>
            
            <div class="form-group">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="llm_enabled" name="llm_enabled" {% if llm_enabled == 'true' %}checked{% endif %}>
                    <label for="llm_enabled">Enable LLM Processing</label>
                </div>
                <small>Process documents with Qwen1.5-1.8B for summarization and correction (requires model download)</small>
            </div>
            
            <div class="form-group">
                <label>Model Status</label>
                <div class="status-info">
                    <span class="status-badge {% if llm_model_info.model_exists %}status-success{% else %}status-warning{% endif %}">
                        {% if llm_model_info.model_exists %}✓ Model Found{% else %}⚠ Model Not Found{% endif %}
                    </span>
                    {% if llm_model_info.model_path %}
                    <small style="display: block; margin-top: 5px;">Path: {{ llm_model_info.model_path }}</small>
                    {% else %}
                    <small style="display: block; margin-top: 5px;">See <a href="https://github.com/PetengDedet/markitdown-api/blob/main/LLM_SETUP.md" target="_blank">LLM_SETUP.md</a> for installation instructions</small>
                    {% endif %}
                </div>
            </div>
            
            <div class="form-group">
                <label for="llm_task">LLM Task</label>
                <select id="llm_task" name="llm_task">
                    <option value="summarize_and_correct" {% if llm_task == 'summarize_and_correct' %}selected{% endif %}>Summarize and Correct</option>
                    <option value="correct_only" {% if llm_task == 'correct_only' %}selected{% endif %}>Correct Only (No Summarization)</option>
                </select>
                <small>Choose whether to summarize content or just correct errors</small>
            </div>
            
            <div class="form-group">
                <label for="llm_max_tokens">Max Tokens</label>
                <input type="number" id="llm_max_tokens" name="llm_max_tokens" value="{{ llm_max_tokens }}" min="256" max="4096" required>
                <small>Maximum length of generated output (256-4096, higher = longer output)</small>
            </div>
            
            <div class="form-group">
                <label for="llm_temperature">Temperature</label>
                <input type="number" id="llm_temperature" name="llm_temperature" value="{{ llm_temperature }}" min="0.0" max="1.0" step="0.1" required>
                <small>Creativity level (0.0-1.0, lower = more focused, higher = more creative)</small>
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
</div>
{% endblock %}
